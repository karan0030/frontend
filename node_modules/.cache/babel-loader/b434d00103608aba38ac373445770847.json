{"ast":null,"code":"var _jsxFileName = \"D:\\\\mernproj\\\\projfrontend\\\\src\\\\admin\\\\UpdateProduct.js\";\nimport React, { useState, useEffect } from 'react';\nimport Base from '../core/Base';\nimport { Link } from 'react-router-dom';\nimport { getCategories, getProduct, updateProduct } from './helper/adminapicall';\nimport { isAuthenticated } from '../auth/helper';\n\nconst UpdateProduct = ({\n  match\n}) => {\n  const {\n    user,\n    token\n  } = isAuthenticated();\n  const [values, setValues] = useState({\n    name: \"\",\n    description: \"\",\n    price: \"\",\n    stock: \"\",\n    photo: \"\",\n    error: \"\",\n    getRedirect: false,\n    formData: \"\",\n    category: \"\",\n    categories: [],\n    loading: false,\n    createdProduct: \"\"\n  });\n  const {\n    name,\n    description,\n    price,\n    stock,\n    photo,\n    error,\n    getRedirect,\n    formData,\n    category,\n    categories,\n    loading,\n    createdProduct\n  } = values;\n\n  const preload = productId => {\n    getProduct(productId).then(data => {\n      if (data.error) {\n        setValues({ ...values,\n          error: error.data\n        });\n      } else {\n        getAllCategories();\n        setValues({ ...values,\n          name: data.name,\n          description: data.description,\n          price: data.price,\n          stock: data.stock,\n          photo: data.photo,\n          category: data.category._id,\n          formData: new FormData()\n        });\n        console.log(categories.name);\n      }\n    }).catch(err => console.log(err));\n  };\n\n  const getAllCategories = () => {\n    getCategories().then(data => {\n      if (data.error) {\n        setValues({ ...values,\n          error: error.data\n        });\n      } else {\n        setValues({\n          categories: data,\n          formData: new FormData()\n        });\n      }\n    });\n  };\n\n  useEffect(() => {\n    preload(match.params.productId);\n  }, []);\n\n  const handleChange = name => event => {\n    const value = name === \"photo\" ? event.target.files[0] : event.target.value;\n    formData.set(name, value);\n    setValues({ ...values,\n      [name]: value\n    });\n  };\n\n  const onSubmit = event => {\n    event.preventDefault();\n    setValues({ ...values,\n      error: \"\",\n      loading: true\n    });\n    updateProduct(match.params.productId, user._id, token, formData).then(data => {\n      if (data.error) {\n        setValues({ ...values,\n          error: data.error\n        });\n      } else {\n        setValues({ ...values,\n          name: \"\",\n          description: \"\",\n          price: \"\",\n          stock: \"\",\n          photo: \"\",\n          loading: false,\n          createdProduct: data.name\n        });\n      }\n    });\n  };\n\n  const successMessage = () => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert alert-success mt-3\",\n    style: {\n      display: createdProduct ? \"\" : \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, createdProduct, \" Updated\"));\n\n  const warningMessage = () => {\n    if (error) {\n      return /*#__PURE__*/React.createElement(\"h4\", {\n        className: \"text-warning\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 20\n        }\n      }, \"Update failed !!!! \");\n    }\n  };\n\n  const createProductForm = () => /*#__PURE__*/React.createElement(\"form\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, \"Post photo\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"btn btn-block btn-success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleChange(\"photo\"),\n    type: \"file\",\n    name: \"photo\",\n    accept: \"image\",\n    required: true,\n    placeholder: \"choose a file\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleChange(\"name\"),\n    name: \"photo\",\n    className: \"form-control\",\n    placeholder: \"Name\",\n    required: true,\n    value: name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"textarea\", {\n    onChange: handleChange(\"description\"),\n    name: \"photo\",\n    className: \"form-control\",\n    placeholder: \"Description\",\n    required: true,\n    value: description,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleChange(\"price\"),\n    type: \"number\",\n    className: \"form-control\",\n    placeholder: \"Price\",\n    required: true,\n    value: price,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    onChange: handleChange(\"category\"),\n    className: \"form-control\",\n    placeholder: \"Category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 15\n    }\n  }, \"Select\"), categories && categories.map((cate, index) => /*#__PURE__*/React.createElement(\"option\", {\n    key: index,\n    value: cate._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 23\n    }\n  }, cate.name)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleChange(\"stock\"),\n    type: \"number\",\n    className: \"form-control\",\n    placeholder: \"Quantity\",\n    required: true,\n    value: stock,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    onClick: onSubmit,\n    className: \"btn btn-outline-success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 11\n    }\n  }, \"Create Product\"));\n\n  return /*#__PURE__*/React.createElement(Base, {\n    title: \"Update Product\",\n    description: \"update product here\",\n    className: \"container bg-info p-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/admin/dashboard\",\n    className: \"btn btn-md btn-dark mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 10\n    }\n  }, \" Admin Home\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row bg-dark text-white rounded\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 10\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-8 offset-md-2 mb-3 mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 10\n    }\n  }, successMessage(), warningMessage(), createProductForm())));\n};\n\nexport default UpdateProduct;","map":{"version":3,"sources":["D:/mernproj/projfrontend/src/admin/UpdateProduct.js"],"names":["React","useState","useEffect","Base","Link","getCategories","getProduct","updateProduct","isAuthenticated","UpdateProduct","match","user","token","values","setValues","name","description","price","stock","photo","error","getRedirect","formData","category","categories","loading","createdProduct","preload","productId","then","data","getAllCategories","_id","FormData","console","log","catch","err","params","handleChange","event","value","target","files","set","onSubmit","preventDefault","successMessage","display","warningMessage","createProductForm","map","cate","index"],"mappings":"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","sourcesContent":["import React ,{useState,useEffect} from 'react';\r\nimport Base from '../core/Base';\r\nimport {Link } from 'react-router-dom'\r\nimport {getCategories, getProduct,updateProduct} from './helper/adminapicall'\r\nimport { isAuthenticated } from '../auth/helper';\r\n\r\n\r\n\r\nconst UpdateProduct=({match})=>{\r\n    \r\nconst {user,token}= isAuthenticated();\r\n    const [values,setValues] =useState({\r\n        name:\"\",\r\n        description:\"\",\r\n        price:\"\",\r\n        stock:\"\",\r\n        photo:\"\",\r\n        error:\"\",\r\n        getRedirect:false,\r\n        formData:\"\",\r\n        category:\"\",\r\n        categories:[],\r\n        loading:false,\r\n        createdProduct:\"\"\r\n\r\n    });\r\n   \r\n    const { \r\n            name,description,price,stock,photo,error,getRedirect,formData,category,\r\n            categories,loading,createdProduct\r\n           }= values;\r\n\r\n    const preload =(productId)=>{\r\n        getProduct(productId).then(data=>{\r\n           \r\n            if(data.error){\r\n                setValues({...values,error:error.data})\r\n            }\r\n            else{\r\n                getAllCategories()\r\n                setValues({\r\n                    ...values,\r\n                     name:data.name,\r\n                     description:data.description,\r\n                     price:data.price,\r\n                     stock:data.stock,\r\n                     photo:data.photo,\r\n                     category:data.category._id,\r\n                     formData:new FormData\r\n                     \r\n                })\r\n                \r\n                console.log(categories.name);\r\n            }\r\n        }).catch(err=>console.log(err))\r\n    }  \r\n    \r\n    const getAllCategories=()=>{\r\n        getCategories().then(data=>{\r\n            if(data.error){\r\n                setValues({...values,error:error.data})\r\n            } \r\n            else{\r\n                setValues({categories:data,formData:new FormData})\r\n            }\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        preload(match.params.productId)\r\n       \r\n    }, [])\r\n\r\n    const handleChange =name=>event=>{\r\n        const value= name===\"photo\"?event.target.files[0]:event.target.value\r\n        formData.set(name,value)\r\n        setValues({...values,[name]:value})\r\n    }\r\n\r\n    const onSubmit=(event)=>{\r\n        event.preventDefault();\r\n        setValues({...values,error:\"\",loading:true});\r\n        updateProduct(match.params.productId,user._id,token,formData).then(data=>{\r\n            if(data.error){\r\n                setValues({...values,error:data.error})\r\n            }\r\n            else{\r\n                setValues({...values,\r\n                    name:\"\",\r\n                    description:\"\",\r\n                    price:\"\",\r\n                    stock:\"\",\r\n                    photo:\"\",\r\n                    loading:false,\r\n                    createdProduct:data.name})\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n    const successMessage=()=>(\r\n        <div className=\"alert alert-success mt-3\" style={{display : createdProduct?\"\":\"none\"}}>\r\n        <h4>{createdProduct} Updated</h4>\r\n        </div>\r\n           \r\n    \r\n       \r\n    )\r\n\r\n    const warningMessage=()=>{\r\n        if(error){\r\n            return <h4 className=\"text-warning\">Update failed !!!! </h4>\r\n        }\r\n       \r\n    }\r\n\r\n    const createProductForm = () => (\r\n        <form >\r\n          <span>Post photo</span>\r\n          <div className=\"form-group\">\r\n            <label className=\"btn btn-block btn-success\">\r\n              <input\r\n                onChange={handleChange(\"photo\")}\r\n                type=\"file\"\r\n                name=\"photo\"\r\n                accept=\"image\"\r\n                required\r\n                placeholder=\"choose a file\"\r\n              />\r\n            </label>\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <input\r\n              onChange={handleChange(\"name\")}\r\n              name=\"photo\"\r\n              className=\"form-control\"\r\n              placeholder=\"Name\"required\r\n              value={name}\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <textarea\r\n              onChange={handleChange(\"description\")}\r\n              name=\"photo\"\r\n              className=\"form-control\"\r\n              placeholder=\"Description\"required\r\n              value={description}\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <input\r\n              onChange={handleChange(\"price\")}\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              placeholder=\"Price\"required\r\n              value={price}\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <select\r\n              onChange={handleChange(\"category\")}\r\n              className=\"form-control\"\r\n              placeholder=\"Category\"\r\n            >\r\n              <option>Select</option>\r\n              {\r\n                  categories && categories.map((cate,index)=>(\r\n                      <option key={index} value={cate._id} >{cate.name}</option>\r\n                  ))\r\n              }\r\n            </select>\r\n          </div>\r\n          \r\n          <div className=\"form-group\">\r\n            <input\r\n              onChange={handleChange(\"stock\")}\r\n              type=\"number\"\r\n              className=\"form-control\"\r\n              placeholder=\"Quantity\"\r\n              required\r\n              value={stock}\r\n            />\r\n          </div>\r\n          \r\n          <button type=\"submit\" onClick={onSubmit} className=\"btn btn-outline-success\">\r\n            Create Product\r\n          </button>\r\n        </form>\r\n      );\r\n\r\n\r\n\r\n    return(\r\n        <Base title=\"Update Product\" description=\"update product here\" className=\"container bg-info p-4\">\r\n         <Link to=\"/admin/dashboard\" className=\"btn btn-md btn-dark mb-4\"> Admin Home</Link>\r\n         <div className=\"row bg-dark text-white rounded\">\r\n         <div className=\"col-md-8 offset-md-2 mb-3 mt-3\">\r\n         {successMessage()}\r\n         {warningMessage()}\r\n          {createProductForm ()}\r\n         </div>\r\n         </div>\r\n        </Base>\r\n    )\r\n}\r\n\r\nexport default UpdateProduct;"]},"metadata":{},"sourceType":"module"}